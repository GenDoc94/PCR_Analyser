Hola ChatGPT, quiero hacer lo siguiente:
A partir de datos de una PCR cuantitativa quiero calcular ratios en las cantidades obtenidas (Quantity).
Tengo archivos de tipo .xls en el que las primeras 7 filas son información inecesaria del experimento de PCR.
Luego tengo diferentes columnas: "Well, Sample Name,Target Name, Task, Reporter, Quencher,Cт, Cт Mean, Cт SD, Quantity, Quantity Mean, Quantity SD, Automatic Ct Threshold, Ct Threshold, Automatic Baseline, Baseline Start, Baseline End, Comments, HIGHSD, NOAMP, OUTLIERRG".
Quiero, de cada muestra que hagas el ratio entre el Target Name que sea y su correspondiente ABL1 (siempre todos los pacientes van a tener ABL1). 
Cada paciente está por triplicado por lo que la Quantity final será la Quantity Mean que ya es la media de los pocillos.
Habrá pacientes (Sample Names) que tengan varios Target Name, por ejemplo un paciente 99999 puede tener p210 y p190 y quiero el ratio de los 2 por ABL1.
Los verdaderos pacientes salen en las filas con Task UNKNOWN.
Quiero que me lo muestres en una tabla resumen.
También quiero que si sólo hay una casilla positiva de 3 para un Target Name de un paciente me lo indiques poniendo que debería revisarlo poniendo "Sólo 1/3 positivo" y en interpretación "Repetir". Si hay 2 de tres positivo indícamelo también aunque en este caso no hay indiación de repetir.
Luego, el ratio quiero que me lo multipliques por 100 o por 10000, pero que me dejes a mí por qué número quiero multiplicarlo entre esos dos números (si es posible con una lista desplegable).
A continuación me gustaría que multiplicases cada ratio de cada paciente por un factor de conversión que te explico a continuación cómo se calcula. Si es posible ponlo al lado del paciente en la tabla resumen.
Para el cálculo del factor de conversión de cada paciente, lo primero es calcular los factores de conversión de cada par de valores de Quantity de las curvas patrón. Se calcula como el cociente entre el valor de cada par y el valor medio que le tocaría a ese par si extrapolásemos el Cт que tienen aplicando su correspondiente recta patrón teniendo en cuenta que habría que despejar la x conociendo la y.
Cada recta tendrá un factor de conversión para cada par de valores.
El factor de conversión por el que hay que multiplicar los ratios es aquel cuyo Quantity esté más cerca en escala logarítmica al Quantity mean del Target del paciente.
Si el ratio del paciente es negativo (0.000) no multipliques por ningún factor de conversión.
En la tabla resumen de ratios quiero los pacientes ordenados de menor a mayor, el target que analizas, el Quantity Mean (con 1 decimal), el ABL1 Mean (con 1 decimal) y el ratio (o 0.0000 si es negativo o el que toque con 4 decimales) y el factor de conversión.
Luego quiero que me añadas la interpretación de cada paciente, que es la siguiente:
- Si el ABL1 Mean tiene <10000 el resultado será "No valorable".
- Si el ratio es de negativo, poner "Al menos MR" seguido de un número que será 4 si ABL1 Mean tiene >10000 pero <32000; 4.5 si está entre 32000 y 100000 y 5 si está superior a 100000.
- Si el ratio es positivo, si es mayor de 0.1 debería de poner "Ausencia de MR". Si es menor de 0.1, será "MR3" si está entre 0.1 y 0.01, "MR4" si está entre 0.01 y 0.0032 y "MR4.5" si está entre 0.0032 y 0.001 y "MR5" si está por debajo de 0.001. 

Además quiero que me calcules las rectas de regresión lineal (curvas patrón) con su b y su a de cada Target Name con 3 decimales. Las rectas son las filas que tienen Task STANDARD. La x es el logaritmo de Quantity y la y son los Cт. Son varios valores de Quantity duplicados todos ellos (van en parejas).
Si en los Cт pone "Undetermined" en una de las 2 determinaciones de las parejas iguales de Quantity quiero que esa no cojas y cojas la otra para el cálculo y que me des un aviso en amarillo de que para la determinación que es (diciéndome la Quantity que es) no había Cт en una de las 2 determinaciones. Si no hay en ninguna de las dos dímelo también.
Los que en Task pone NTC no los tengas en cuenta que son las "aguas".
Si es posible muéstrame un gráfico con las rectas de regresión lineal y los puntos que las forman. Y con los factores de conversión de cada medida de Quantity.

Todo eso me gustaría hacerlo (que creo que es la mejor forma) con python y streamlit.
Cuidado con los errores de NaN.

Dame ya el archivo .py con todo lo que te he pedido para poder ejecutarlo en local.